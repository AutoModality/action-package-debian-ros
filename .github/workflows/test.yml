name: Validate Packaging
on: 
  push:
    branches-ignore:
      - master
jobs:
  default-version:
    runs-on: ubuntu-16.04
    name: Default version uses timestamps
    steps:
      - uses: actions/checkout@v1
      - name: Package
        id: package
        uses: ./  #use the current project relative to root
      - name: The generated package
        run: echo "The artifact is ${{ steps.package.outputs.artifact-path }}"
      - name: Validate package file provided exists
        uses: ./.github/actions/test@local
        with:
          package-file: ${{ steps.package.outputs.artifact-path }}      
  version:
    runs-on: ubuntu-16.04
    name: Package uses version provided
    steps:
      - uses: actions/checkout@v1
      - name: Package
        id: package
        uses: ./  #use the current project relative to root
        with:
          version: 0.0.13
      - name: The generated package
        run: echo "The artifact is ${{ steps.package.outputs.artifact-path }}"
      - name: Confirm package name uses version
        if: contains(steps.package.outputs.artifact-path, '0.0.13')
        run: |
          echo "Expected ${{ steps.package.outputs.artifact-path }} to contain 0.0.13 "
          exit 1
      - name: Validate package file provided exists
        uses: ./.github/actions/test@local
        with:
          package-file: ${{ steps.package.outputs.artifact-path }}

  